<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Booking — Explore Portugal Experience</title>

  <link rel="apple-touch-icon" href="assets/icons/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="assets/icons/apple-touch-icon.png">
  <link rel="stylesheet" href="assets/css/style.css?v=1000" />

  <style>
    .vip-split{display:grid;grid-template-columns:1.15fr .85fr;gap:16px}
    @media(max-width:980px){.vip-split{grid-template-columns:1fr}}
    .vip-card{border:1px solid rgba(212,169,86,.28);background:rgba(255,255,255,.04);border-radius:16px;padding:14px}
    .vip-row{display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .vip-badge{border:1px solid rgba(212,169,86,.22);border-radius:999px;padding:6px 10px;font-size:12px}
    .vip-estimate{font-size:18px;margin:6px 0}
    .vip-muted{font-size:12px;opacity:.85;line-height:1.35}
    .vip-check{display:flex;gap:10px;margin-top:10px}
    .vip-pay-grid{display:grid;gap:10px;margin-top:10px}
    .vip-radio{display:flex;gap:10px;padding:10px;border-radius:14px;border:1px solid rgba(255,255,255,.1);cursor:pointer}
    .vip-radio:hover{border-color:rgba(212,169,86,.35)}
    .vip-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .vip-hidden{display:none}
    .vip-ref{font-family:monospace;font-size:12px;padding:6px 10px;border:1px solid rgba(255,255,255,.15);border-radius:12px}
  </style>
</head>

<body>
<div id="siteHeader"></div>

<main class="page">
<section class="section">
<div class="wrap">
<h1 class="h1">Booking</h1>
<p class="p">Select your details. If you agree with the estimated VIP range, pay immediately and send the request.</p>

<div class="panel">
<div class="vip-split">

<form id="bookingForm">

<!-- ESTIMATE -->
<div class="vip-card">
  <div class="vip-row">
    <span class="vip-badge">Estimated VIP range</span>
    <span class="vip-badge">Payment required to confirm</span>
  </div>
  <div id="estimateLine" class="vip-estimate">€ —</div>
  <div id="estimateNote" class="vip-muted">Select trip + route to calculate.</div>
  <div class="vip-check">
    <input type="checkbox" id="agreeEstimate">
    <label for="agreeEstimate" class="vip-muted">I agree with this estimated range and will pay now.</label>
  </div>
</div>

<div style="height:12px"></div>

<!-- FORM -->
<div class="grid-3">
  <div class="field">
    <label class="label">Trip</label>
    <div class="cselect" data-name="trip">
      <button type="button" class="cselect-btn"><span class="cselect-value">Select</span>▾</button>
      <ul class="cselect-list">
        <li class="cselect-option" data-value="one-way">One-way</li>
        <li class="cselect-option" data-value="return">Return</li>
        <li class="cselect-option" data-value="hourly">Hourly</li>
        <li class="cselect-option" data-value="tour">Private Tour</li>
      </ul>
      <input type="hidden" name="trip">
    </div>
  </div>
  <div class="field"><label class="label">Date</label><input id="dateGo" class="input" type="date"></div>
  <div class="field"><label class="label">Time</label><input id="timeGo" class="input" type="time"></div>
</div>

<div style="height:10px"></div>

<div class="grid-3">
  <div class="field"><label class="label">From</label>
    <div class="cselect" data-name="from">
      <button type="button" class="cselect-btn"><span class="cselect-value">Select</span>▾</button>
      <ul class="cselect-list">
        <li class="cselect-option" data-value="LIS">Lisbon Airport</li>
        <li class="cselect-option" data-value="pt-lisbon-city">Lisbon City</li>
        <li class="cselect-option" data-value="pt-cascais">Cascais</li>
        <li class="cselect-option" data-value="pt-sintra">Sintra</li>
        <li class="cselect-option" data-value="OPO">Porto Airport</li>
      </ul>
      <input type="hidden" name="from">
    </div>
  </div>

  <div class="field"><label class="label">To</label>
    <div class="cselect" data-name="to">
      <button type="button" class="cselect-btn"><span class="cselect-value">Select</span>▾</button>
      <ul class="cselect-list">
        <li class="cselect-option" data-value="pt-lisbon-city">Lisbon City</li>
        <li class="cselect-option" data-value="pt-cascais">Cascais</li>
        <li class="cselect-option" data-value="pt-sintra">Sintra</li>
        <li class="cselect-option" data-value="LIS">Lisbon Airport</li>
      </ul>
      <input type="hidden" name="to">
    </div>
  </div>

  <div class="field"><label class="label">Passengers</label><input id="passengers" class="input" type="number" min="1" value="1"></div>
</div>

<div style="height:12px"></div>

<div class="vip-card">
  <h3 class="label">Payment confirmation</h3>
  <div class="vip-row">
    <div class="vip-ref" id="refCode">REF: —</div>
  </div>

  <div class="vip-check">
    <input type="checkbox" id="paymentDone">
    <label for="paymentDone" class="vip-muted">I have initiated/completed the payment.</label>
  </div>
</div>

<div class="actions" style="margin-top:14px">
  <button id="submitBtn" class="btn btn-gold" type="submit" disabled>Pay & send via WhatsApp</button>
</div>

</form>

<!-- PAY METHODS -->
<aside class="vip-card">
  <h3 class="label">Pay now</h3>

  <div class="vip-pay-grid">
    <label class="vip-radio"><input type="radio" name="pay" value="MB Way"><strong>MB Way</strong></label>
    <label class="vip-radio"><input type="radio" name="pay" value="Revolut"><strong>Revolut</strong></label>
    <label class="vip-radio"><input type="radio" name="pay" value="PayPal"><strong>PayPal</strong></label>
  </div>

  <div class="vip-actions">
    <a id="payNowBtn" class="btn btn-gold vip-hidden" target="_blank">Pay now</a>
  </div>
</aside>

</div>
</div>
</div>
</section>
</main>

<div id="siteFooter"></div>

<script src="assets/js/nav.js?v=1000" defer></script>
<script src="assets/js/dropdowns.js?v=1000" defer></script>

<script>
(function(){
const form=document.getElementById('bookingForm');
const estimateLine=document.getElementById('estimateLine');
const estimateNote=document.getElementById('estimateNote');
const submitBtn=document.getElementById('submitBtn');
const agree=document.getElementById('agreeEstimate');
const paid=document.getElementById('paymentDone');
const refEl=document.getElementById('refCode');
const payBtn=document.getElementById('payNowBtn');

function hidden(n){return form.querySelector(`input[name="${n}"]`)?.value||''}
function ref(){return 'EPE-'+Math.random().toString(36).substring(2,8).toUpperCase()}
const REF=ref(); refEl.textContent='REF: '+REF;

function getSitePhone(){
  const tel=document.querySelector('a[href^="tel:"]');
  if(tel)return tel.getAttribute('href').replace('tel:','').trim();
  const wa=document.querySelector('a[href*="wa.me/"]');
  if(wa){const m=wa.href.match(/wa\.me\/(\d+)/);if(m)return '+'+m[1]}
  return '+351000000000';
}

const PAY_LINKS={
  'MB Way':'mbway:'+getSitePhone(),
  'Revolut':'https://revolut.me/dalilav7js',
  'PayPal':'https://paypal.me/yourpaypal'
};

document.querySelectorAll('input[name="pay"]').forEach(r=>{
  r.addEventListener('change',()=>{
    payBtn.href=PAY_LINKS[r.value];
    payBtn.classList.remove('vip-hidden');
    gate();
  });
});

function estimate(){
  const trip=hidden('trip'),from=hidden('from'),to=hidden('to');
  if(!trip||!from||!to){estimateLine.textContent='€ —';return}
  let min=60,max=120;
  if(trip==='hourly'){min=45;max=75;estimateLine.textContent=`€${min}–€${max}/h`;return}
  if(trip==='tour'){min=220;max=420}
  estimateLine.textContent=`€${min}–€${max}`;
}

function gate(){
  submitBtn.disabled=!(agree.checked && paid.checked && !payBtn.classList.contains('vip-hidden'));
}

setInterval(()=>{estimate();gate()},300);

form.addEventListener('submit',e=>{
  e.preventDefault();
  const txt=`EPE BOOKING%0AREF:${REF}%0AESTIMATE:${estimateLine.textContent}%0APAYMENT CONFIRMED`;
  window.open('https://wa.me/?text='+txt,'_blank');
});
})();
</script>

</body>
</html>
